<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OrbitWatch Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0d1117; color: #c9d1d9; font-family: 'Courier New', monospace; padding: 24px; }
        .header { text-align: center; margin-bottom: 32px; }
        .header h1 { color: #58a6ff; font-size: 28px; margin-bottom: 8px; }
        .header p { color: #8b949e; font-size: 14px; }
        .step { background: #161b22; border: 1px solid #30363d; border-radius: 8px; margin-bottom: 20px; padding: 16px; }
        .step-title { color: #f0883e; font-size: 16px; font-weight: bold; margin-bottom: 12px; }
        .cmd { color: #7ee787; margin-bottom: 8px; }
        .cmd::before { content: '$ '; color: #8b949e; }
        .output { background: #0d1117; border: 1px solid #21262d; border-radius: 4px; padding: 12px; font-size: 13px; white-space: pre-wrap; overflow-x: auto; }
        .highlight { color: #ffa657; }
        .success { color: #3fb950; }
        .alert { color: #f85149; }
        .badge { display: inline-block; background: #1f6feb; color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 8px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ∞Ô∏è OrbitWatch Demo</h1>
        <p>End-to-end Arbitrum Orbit monitoring for Xai SequencerInbox batch gaps</p>
    </div>

    <div class="step">
        <div class="step-title">Step 1: Health Check <span class="badge">API</span></div>
        <div class="cmd">curl http://localhost:3001/health</div>
        <div class="output"><span class="success">{ "ok": true }</span></div>
    </div>

    <div class="step">
        <div class="step-title">Step 2: List Incidents <span class="badge">API</span></div>
        <div class="cmd">curl http://localhost:3001/incidents?limit=5</div>
        <div class="output">[{
  "id": "98b58b42-03f2-4f31-8c60-502c9bb7a9aa",
  "created_at": "2026-02-25T11:04:08.444Z",
  "route_id": "<span class="highlight">xai</span>",
  "rule_type": "<span class="alert">BATCH_POSTING_GAP</span>",
  "severity": "<span class="alert">HIGH</span>",
  "reason": "No new SequencerBatchDelivered event for <span class="highlight">158s</span> (threshold: 30s)",
  "evidence_cid": "<span class="success">QmPPHqa7fPZGYiPCLSRayurYGQncZaAyCpfvi3vNvieHTj</span>"
}]</div>
    </div>

    <div class="step">
        <div class="step-title">Step 3: IPFS Evidence Bundle <span class="badge">IPFS</span></div>
        <div class="cmd">curl -sL http://localhost:8080/ipfs/QmPPHqa7...HTj</div>
        <div class="output">{
  "version": "v1",
  "routeId": "<span class="highlight">xai</span>",
  "ruleType": "BATCH_POSTING_GAP",
  "severity": "HIGH",
  "thresholdSecs": 30,
  "computedLastBatchAgeSecs": <span class="highlight">158</span>,
  "sequencerInboxAddr": "0x995a9d3ca121D48d21087eDE20bc8acb2398c8B1",
  "blockRange": { "fromBlock": 435798350, "toBlock": 435798849 },
  "decision": { "fired": <span class="success">true</span>, "reason": "..." },
  "bundleHash": "<span class="success">7aa4060bc0538693f8c4c0ec585ff4912298426938bdbc46ef2ddc45b3db803a</span>"
}</div>
    </div>

    <div class="step">
        <div class="step-title">Step 4: Telegram Alert <span class="badge">TELEGRAM</span></div>
        <div class="output"><span class="alert">üö® OrbitWatch Demo Alert</span>

Route: <span class="highlight">xai</span>
Rule: <span class="alert">BATCH_POSTING_GAP</span>
Severity: HIGH
Reason: No new SequencerBatchDelivered event for 158s (threshold: 30s)

Evidence:
  ipfs://<span class="success">QmPPHqa7fPZGYiPCLSRayurYGQncZaAyCpfvi3vNvieHTj</span>
  http://localhost:8080/ipfs/QmPPHqa7fPZGYiPCLSRayurYGQncZaAyCpfvi3vNvieHTj

Recompute:
  <span class="cmd" style="display:inline">pnpm recompute -- --cid QmPPHqa7...HTj</span></div>
    </div>

    <div class="step">
        <div class="step-title">Step 5: Recompute CLI <span class="badge">VERIFY</span></div>
        <div class="cmd">pnpm recompute -- --cid QmPPHqa7fPZGYiPCLSRayurYGQncZaAyCpfvi3vNvieHTj</div>
        <div class="output">=== OrbitWatch Recompute CLI ===
Evidence bundle v1 | Route: xai | Rule: BATCH_POSTING_GAP

Re-running eth_getLogs on https://arb1.arbitrum.io/rpc...
Found <span class="success">1 logs</span> (bundle had 1 logs)

--- Recompute Result ---
Verdict: <span class="success">MATCH ‚úÖ</span>
  Bundle computedLastBatchAgeSecs: <span class="highlight">158s</span>
  Recomputed lastBatchAgeSecs:     <span class="highlight">158s</span>
  Drift:                           <span class="success">0s</span> (tolerance: 10s)
  Last batch block:                435798406
  Last batch txHash:               0x2ba38d76de68822f0519f7219f522dbffb9147016ef...
  Bundle hash:                     7aa4060bc0538693f8c4c0ec585ff49122984269...</div>
    </div>
</body>
</html>
